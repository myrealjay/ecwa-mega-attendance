import{_ as v,B as b,M as k,r as c,o as r,c as i,a as e,b as d,w as E,v as C,F as p,d as m,t as u,e as y,f as P,g as f}from"./app-2f14000c.js";import{P as M}from"./Pagination-b51db5c7.js";import{F as w}from"./FileField-f847e92f.js";const A={data(){return{currentPage:1,pageSize:10,form:{picture:""},errors:{},registerModalOpen:!1,userData:[],lengthData:[5,10,20,30,40,50,100],tableData:{search:"",currentPage:1,length:5,links:{},from:"",to:"",total:"",sort:"id",sort_direction:"ASC"}}},mounted(){this.fetchData()},computed:{},methods:{deleteEvent(o){confirm("Are you sure you want to delete this event?")&&this.makeRequest("POST",`${this.endpoints.deleteEvent}/${o.id}`,{},{}).then(t=>{this.sweetAlert().success("Event Deleted successfully"),this.fetchData()}).catch(t=>{this.sweetAlert().error("Error Deleting event"),console.log(t.response.data)}).finally(()=>{this.hideLoader()})},sortBy(o){this.tableData.sort=o,this.tableData.sort_direction=="ASC"?this.tableData.sort_direction="DESC":this.tableData.sort_direction="ASC",this.fetchData()},setPage(o){this.tableData.currentPage=o,this.fetchData()},fetchData(o=this.endpoints.fetchEvent){this.makeRequest("GET",`${o}?page=${this.tableData.currentPage}`,this.tableData).then(t=>{let l=t.data.data;this.tableData.currentPage=l.current_page,this.tableData.from=l.from,this.tableData.to=l.to,this.tableData.prevPage=l.prev_page_url,this.tableData.nextPage=l.next_page_url,this.tableData.links=l.links,this.tableData.total=l.total,this.userData=l.data}).catch(t=>{console.log(t.response.data)})},showEventModal(){this.registerModalOpen=!0},register(){this.errors={};let o=new FormData;for(let t in this.form)o.append(t,this.form[t]);this.showLoader(),this.makeRequest("POST",this.endpoints.uploadEvent,{},o).then(t=>{this.sweetAlert().success("Event Added successfully"),this.registerModalOpen=!1,this.form={picture:""},this.fetchData()}).catch(t=>{this.sweetAlert().error("Error Registration"),console.log(t.response.data)}).finally(()=>{this.hideLoader()})}},components:{Button:b,Modal:k,Pagination:M,FileField:w}},B={class:"button-container"},F=e("h2",null,"CHURCH EVENTS",-1),S={class:"search-items"},V=["value"],x=["value"],O=e("th",null,"Date Uploaded",-1),U=e("th",null,"Actions",-1),N=["onClick"],R=e("h4",null,"Upload a 1500 X 500 image",-1),T=e("div",{class:"line"},null,-1),L={class:"pt-3"};function q(o,t,l,H,s,n){const h=c("Button"),g=c("Pagination"),D=c("FileField"),_=c("Modal");return r(),i("div",null,[e("div",B,[d(h,{text:"ADD EVENT",color:"primary",icon:"mdi mdi-plus-circle",onButtonClicked:t[0]||(t[0]=a=>n.showEventModal())})]),F,e("div",S,[E(e("select",{class:"form-control length-select","onUpdate:modelValue":t[1]||(t[1]=a=>s.tableData.length=a),onChange:t[2]||(t[2]=a=>n.fetchData())},[(r(!0),i(p,null,m(s.lengthData,a=>(r(),i("option",{value:a,key:a},u(a),9,V))),128)),s.tableData.total?(r(),i("option",{key:0,value:s.tableData.total},"All",8,x)):y("",!0)],544),[[C,s.tableData.length]])]),e("table",null,[e("thead",null,[e("tr",null,[e("th",{onClick:t[3]||(t[3]=a=>n.sortBy("first_name"))},"Event Image Url"),O,U])]),e("tbody",null,[(r(!0),i(p,null,m(s.userData,a=>(r(),i("tr",{key:a.id,class:"detail-click"},[e("td",null,u(a.url),1),e("td",null,u(o.formatDate(a.created_at,!0)),1),e("td",null,[e("button",{onClick:P(X=>n.deleteEvent(a),["prevent"]),class:"btn btn-danger"},"X",8,N)])]))),128))])]),d(g,{from:s.tableData.from,to:s.tableData.to,links:s.tableData.links,total:s.tableData.total,onPageClicked:n.setPage},null,8,["from","to","links","total","onPageClicked"]),d(_,{id:"registerModal",title:"Add Event",open:s.registerModalOpen,onClosed:t[6]||(t[6]=a=>s.registerModalOpen=!1),large:!1},{buttons:f(()=>[d(h,{icon:"mdi-send",text:"Upload",color:"primary",onButtonClicked:t[5]||(t[5]=a=>n.register())})]),default:f(()=>[e("div",null,[R,T,e("form",L,[d(D,{modelValue:s.form.picture,"onUpdate:modelValue":t[4]||(t[4]=a=>s.form.picture=a),error:s.errors.picture?s.errors.picture[0]:""},null,8,["modelValue","error"])])])]),_:1},8,["open"])])}const j=v(A,[["render",q]]);export{j as default};
