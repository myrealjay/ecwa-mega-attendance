import{_ as y,B as k,S as D,M as A,r,o,c as n,a as s,b as m,w as C,v as w,F as d,d as p,t as T,e as S,h as P,g as c}from"./app-aa476324.js";import{M}from"./Message-985bf34e.js";import{E as x}from"./Editor-114cef40.js";import{P as B}from"./Pagination-31fd8b26.js";const V={components:{Message:M,Button:k,editor:x,SingleSelect:D,Modal:A,Pagination:B},mounted(){this.makeRequest("GET",this.endpoints.userStructre).then(e=>{this.userStructure=e.data.data}).catch(e=>{console.log(e.response.data)}),this.makeRequest("GET",this.endpoints.getCategories).then(e=>{this.categories=e.data.data}).catch(e=>{console.log(e.response)}),this.fetchTemplates()},data(){return{emailTemplateOpen:!1,userStructure:{},emailTemplate:{email_category_id:"",template:""},categories:[],templates:[],paginationData:{},edit:!1,tableData:{length:15,currentPage:1},lengthData:[10,15,20,30,40,50,100]}},methods:{addAttribute(e){this.emailTemplate.template+=e},setPage(e){this.tableData.currentPage=e,this.fetchTemplates()},fetchTemplates(){this.makeRequest("GET",`${this.endpoints.fetchEmailTemplates}?page=${this.tableData.currentPage}`,this.tableData).then(e=>{this.templates=e.data.data.data,this.paginationData=e.data.data}).catch(e=>{console.log(e.response.data)})},showEmailTemplateModal(){this.emailTemplateOpen=!0},getAttributes(){let e="";for(let u in this.userStructure)e+=`$${u}$ , `;return e.split(",")},addEmailTemplate(){this.showLoader(),this.makeRequest("POST",this.endpoints.createEmailTemplate,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error creating template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},editTemplate(e){this.emailTemplate={...e},this.emailTemplateOpen=!0,this.edit=!0},editEmailTemplate(){this.showLoader(),this.makeRequest("PUT",`${this.endpoints.updateEmailTemplate}/${this.emailTemplate.id}`,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template Edit successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.edit=!1,this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error editing template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},deleteTemplate(e){confirm("Are you sure you want to delete this template?")&&this.makeRequest("DELETE",`${this.endpoints.deleteEmailTemplate}/${e}`).then(l=>{this.sweetAlert().success("Template deleted successfully"),this.fetchTemplates()}).catch(l=>{this.sweetAlert().error("Error deleting template"),console.log(l.response.data)})}}},L={class:"button-container"},O=["value"],q=["value"],R=s("div",{class:"line"},null,-1),U=s("h2",{class:"head"},"Email Templates",-1),G={class:"messages"},N=["onClick"],F=["onClick"],j=s("b",null,"You can use any of these attributes:",-1),I=s("br",null,null,-1),Y=["onClick"],z=s("div",{class:"line"},null,-1);function H(e,l,u,J,a,i){const h=r("Button"),_=r("Message"),f=r("Pagination"),b=r("SingleSelect"),E=r("editor"),v=r("Modal");return o(),n("div",null,[s("div",L,[m(h,{text:"ADD EMAIL TEMPLATE",color:"primary",icon:"mdi mdi-plus-box",onButtonClicked:l[0]||(l[0]=t=>i.showEmailTemplateModal())}),C(s("select",{class:"form-control select-legnth",name:"",id:"","onUpdate:modelValue":l[1]||(l[1]=t=>a.tableData.length=t),onChange:l[2]||(l[2]=t=>i.fetchTemplates())},[(o(!0),n(d,null,p(a.lengthData,t=>(o(),n("option",{key:t,value:t},T(t),9,O))),128)),a.paginationData.total?(o(),n("option",{key:0,value:a.paginationData.total},"All",8,q)):S("",!0)],544),[[w,a.tableData.length]])]),R,U,s("div",G,[(o(!0),n(d,null,p(a.templates,t=>(o(),P(_,{key:t.id,message:t.template,category:"Category:"+t.category?t.category.name:""},{actions:c(()=>[s("button",{onClick:g=>i.editTemplate(t)},"Edit",8,N),s("button",{onClick:g=>i.deleteTemplate(t.id)},"Delete",8,F)]),_:2},1032,["message","category"]))),128))]),m(f,{from:a.paginationData.from,to:a.paginationData.to,links:a.paginationData.links,total:a.paginationData.total,onPageClicked:i.setPage},null,8,["from","to","links","total","onPageClicked"]),m(v,{id:"addEmailTemplate",title:"Add Email Template",open:a.emailTemplateOpen,onClosed:l[6]||(l[6]=t=>a.emailTemplateOpen=!1),large:!0},{buttons:c(()=>[m(h,{icon:"mdi-book",text:a.edit?"Edit Template":"Submit Template",color:"primary",onButtonClicked:l[5]||(l[5]=t=>a.edit?i.editEmailTemplate():i.addEmailTemplate())},null,8,["text"])]),default:c(()=>[s("div",null,[s("div",null,[j,I,(o(!0),n(d,null,p(i.getAttributes(),t=>(o(),n("button",{class:"btn btn-info",style:{margin:"2px"},key:t,onClick:g=>i.addAttribute(t)},T(t),9,Y))),128))]),z,m(b,{options:a.categories,custom_value:"id",modelValue:a.emailTemplate.email_category_id,"onUpdate:modelValue":l[3]||(l[3]=t=>a.emailTemplate.email_category_id=t),text:"name",label:"Category"},null,8,["options","modelValue"]),m(E,{init:{height:200,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","media table paste code help wordcount"],toolbar:"undo redo | formatselect | bold italic backcolor |                             alignleft aligncenter alignright alignjustify |                             bullist numlist outdent indent | removeformat | help"},modelValue:a.emailTemplate.template,"onUpdate:modelValue":l[4]||(l[4]=t=>a.emailTemplate.template=t)},null,8,["modelValue"])])]),_:1},8,["open"])])}const Z=y(V,[["render",H]]);export{Z as default};
