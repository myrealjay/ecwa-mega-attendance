import{w as P,d as N,t as q,r as F,n as M,o as G,a as K,b as z,c as H,h as B,_ as W,B as Y,S as J,M as Q,e as T,f as p,g,i as m,j as _,k as X,v as Z,F as k,l as A,m as O,p as $,q as ee,s as w}from"./app-05d0b7e5.js";import{M as te}from"./Message-d0100340.js";import{P as ne}from"./Pagination-d05d65c6.js";var ae=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ie=function(e){return ae.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},oe=function(e,t,a){Object.keys(t).filter(ie).forEach(function(r){var n=t[r];typeof n=="function"&&(r==="onInit"?n(e,a):a.on(r.substring(2),function(i){return n(i,a)}))})},le=function(e,t,a,r){var n=e.modelEvents?e.modelEvents:null,i=Array.isArray(n)?n.join(" "):n;P(r,function(c,s){a&&typeof c=="string"&&c!==s&&c!==a.getContent({format:e.outputFormat})&&a.setContent(c)}),a.on(i||"change input undo redo",function(){t.emit("update:modelValue",a.getContent({format:e.outputFormat}))})},re=function(e,t,a,r,n,i){r.setContent(i()),a.attrs["onUpdate:modelValue"]&&le(t,a,r,n),oe(e,a.attrs,r)},V=0,U=function(e){var t=Date.now(),a=Math.floor(Math.random()*1e9);return V++,e+"_"+a+V+String(t)},se=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},L=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},ue=function(e,t){return L(e).concat(L(t))},de=function(e){return e==null},x=function(){return{listeners:[],scriptId:U("tiny-script"),scriptLoaded:!1}},ce=function(){var e=x(),t=function(n,i,c,s){var l=i.createElement("script");l.referrerPolicy="origin",l.type="application/javascript",l.id=n,l.src=c;var f=function(){l.removeEventListener("load",f),s()};l.addEventListener("load",f),i.head&&i.head.appendChild(l)},a=function(n,i,c){e.scriptLoaded?c():(e.listeners.push(c),n.getElementById(e.scriptId)||t(e.scriptId,n,i,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},r=function(){e=x()};return{load:a,reinitialize:r}},me=ce(),fe=function(){return typeof window<"u"?window:global},v=function(){var e=fe();return e&&e.tinymce?e.tinymce:null},pe={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},h=globalThis&&globalThis.__assign||function(){return h=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++){t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},h.apply(this,arguments)},ge=function(e,t,a,r){return e(r||"div",{id:t,ref:a})},ve=function(e,t,a){return e("textarea",{id:t,visibility:"hidden",ref:a})},he=N({props:pe,setup:function(e,t){var a=e.init?h({},e.init):{},r=q(e),n=r.disabled,i=r.modelValue,c=r.tagName,s=F(null),l=null,f=e.id||U("tiny-vue"),b=e.init&&e.init.inline||e.inline,E=!!t.attrs["onUpdate:modelValue"],o=!0,S=e.initialValue?e.initialValue:"",D="",R=function(u){return E?function(){return i!=null&&i.value?i.value:""}:function(){return u?S:D}},C=function(){var u=R(o),d=h(h({},a),{readonly:e.disabled,selector:"#"+f,plugins:ue(a.plugins,e.plugins),toolbar:e.toolbar||a.toolbar,inline:b,setup:function(y){l=y,y.on("init",function(I){return re(I,e,t,y,i,u)}),typeof a.setup=="function"&&a.setup(y)}});se(s.value)&&(s.value.style.visibility=""),v().init(d),o=!1};P(n,function(u){var d;l!==null&&(typeof((d=l.mode)===null||d===void 0?void 0:d.set)=="function"?l.mode.set(u?"readonly":"design"):l.setMode(u?"readonly":"design"))}),P(c,function(u){var d;E||(D=l.getContent()),(d=v())===null||d===void 0||d.remove(l),M(function(){return C()})}),G(function(){if(v()!==null)C();else if(s.value&&s.value.ownerDocument){var u=e.cloudChannel?e.cloudChannel:"5",d=e.apiKey?e.apiKey:"no-api-key",y=de(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+d+"/tinymce/"+u+"/tinymce.min.js":e.tinymceScriptSrc;me.load(s.value.ownerDocument,y,C)}}),K(function(){v()!==null&&v().remove(l)}),b||(z(function(){o||C()}),H(function(){var u;E||(D=l.getContent()),(u=v())===null||u===void 0||u.remove(l)}));var j=function(u){var d;D=l.getContent(),(d=v())===null||d===void 0||d.remove(l),a=h(h({},a),u),M(function(){return C()})};return t.expose({rerender:j}),function(){return b?ge(B,f,s,e.tagName):ve(B,f,s)}}});const ye={components:{Message:te,Button:Y,editor:he,SingleSelect:J,Modal:Q,Pagination:ne},mounted(){this.makeRequest("GET",this.endpoints.userStructre).then(e=>{this.userStructure=e.data.data}).catch(e=>{console.log(e.response.data)}),this.makeRequest("GET",this.endpoints.getCategories).then(e=>{this.categories=e.data.data}).catch(e=>{console.log(e.response)}),this.fetchTemplates()},data(){return{emailTemplateOpen:!1,userStructure:{},emailTemplate:{email_category_id:"",template:""},categories:[],templates:[],paginationData:{},edit:!1,tableData:{length:15,currentPage:1},lengthData:[10,15,20,30,40,50,100]}},methods:{addAttribute(e){this.emailTemplate.template+=e},setPage(e){this.tableData.currentPage=e,this.fetchTemplates()},fetchTemplates(){this.makeRequest("GET",`${this.endpoints.fetchEmailTemplates}?page=${this.tableData.currentPage}`,this.tableData).then(e=>{this.templates=e.data.data.data,this.paginationData=e.data.data}).catch(e=>{console.log(e.response.data)})},showEmailTemplateModal(){this.emailTemplateOpen=!0},getAttributes(){let e="";for(let a in this.userStructure)e+=`$${a}$ , `;return e.split(",")},addEmailTemplate(){this.showLoader(),this.makeRequest("POST",this.endpoints.createEmailTemplate,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error creating template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},editTemplate(e){this.emailTemplate={...e},this.emailTemplateOpen=!0,this.edit=!0},editEmailTemplate(){this.showLoader(),this.makeRequest("PUT",`${this.endpoints.updateEmailTemplate}/${this.emailTemplate.id}`,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template Edit successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.edit=!1,this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error editing template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},deleteTemplate(e){confirm("Are you sure you want to delete this template?")&&this.makeRequest("DELETE",`${this.endpoints.deleteEmailTemplate}/${e}`).then(t=>{this.sweetAlert().success("Template deleted successfully"),this.fetchTemplates()}).catch(t=>{this.sweetAlert().error("Error deleting template"),console.log(t.response.data)})}}},Te={class:"button-container"},_e=["value"],be=["value"],Ee=m("div",{class:"line"},null,-1),Ce=m("h2",{class:"head"},"Email Templates",-1),Se={class:"messages"},De=["onClick"],ke=["onClick"],Ae=m("b",null,"You can use any of these attributes:",-1),we=m("br",null,null,-1),Pe=["onClick"],Me=m("div",{class:"line"},null,-1);function Be(e,t,a,r,n,i){const c=T("Button"),s=T("Message"),l=T("Pagination"),f=T("SingleSelect"),b=T("editor"),E=T("Modal");return p(),g("div",null,[m("div",Te,[_(c,{text:"ADD EMAIL TEMPLATE",color:"primary",icon:"mdi mdi-plus-box",onButtonClicked:t[0]||(t[0]=o=>i.showEmailTemplateModal())}),X(m("select",{class:"form-control select-legnth",name:"",id:"","onUpdate:modelValue":t[1]||(t[1]=o=>n.tableData.length=o),onChange:t[2]||(t[2]=o=>i.fetchTemplates())},[(p(!0),g(k,null,A(n.lengthData,o=>(p(),g("option",{key:o,value:o},O(o),9,_e))),128)),n.paginationData.total?(p(),g("option",{key:0,value:n.paginationData.total},"All",8,be)):$("",!0)],544),[[Z,n.tableData.length]])]),Ee,Ce,m("div",Se,[(p(!0),g(k,null,A(n.templates,o=>(p(),ee(s,{key:o.id,message:o.template,category:"Category:"+o.category?o.category.name:""},{actions:w(()=>[m("button",{onClick:S=>i.editTemplate(o)},"Edit",8,De),m("button",{onClick:S=>i.deleteTemplate(o.id)},"Delete",8,ke)]),_:2},1032,["message","category"]))),128))]),_(l,{from:n.paginationData.from,to:n.paginationData.to,links:n.paginationData.links,total:n.paginationData.total,onPageClicked:i.setPage},null,8,["from","to","links","total","onPageClicked"]),_(E,{id:"addEmailTemplate",title:"Add Email Template",open:n.emailTemplateOpen,onClosed:t[6]||(t[6]=o=>n.emailTemplateOpen=!1),large:!0},{buttons:w(()=>[_(c,{icon:"mdi-book",text:n.edit?"Edit Template":"Submit Template",color:"primary",onButtonClicked:t[5]||(t[5]=o=>n.edit?i.editEmailTemplate():i.addEmailTemplate())},null,8,["text"])]),default:w(()=>[m("div",null,[m("div",null,[Ae,we,(p(!0),g(k,null,A(i.getAttributes(),o=>(p(),g("button",{class:"btn btn-info",style:{margin:"2px"},key:o,onClick:S=>i.addAttribute(o)},O(o),9,Pe))),128))]),Me,_(f,{options:n.categories,custom_value:"id",modelValue:n.emailTemplate.email_category_id,"onUpdate:modelValue":t[3]||(t[3]=o=>n.emailTemplate.email_category_id=o),text:"name",label:"Category"},null,8,["options","modelValue"]),_(b,{init:{height:200,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","media table paste code help wordcount"],toolbar:"undo redo | formatselect | bold italic backcolor |                             alignleft aligncenter alignright alignjustify |                             bullist numlist outdent indent | removeformat | help"},modelValue:n.emailTemplate.template,"onUpdate:modelValue":t[4]||(t[4]=o=>n.emailTemplate.template=o)},null,8,["modelValue"])])]),_:1},8,["open"])])}const xe=W(ye,[["render",Be]]);export{xe as default};
