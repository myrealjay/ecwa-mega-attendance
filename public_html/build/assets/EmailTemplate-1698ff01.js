import{w,d as N,t as q,r as F,n as A,o as G,a as K,b as z,c as H,h as P,_ as W,B as Y,S as J,M as Q,e as h,f as y,g as C,i as m,j as T,k as X,v as Z,F as M,l as V,m as B,p as $,q as ee,s as k,u as te}from"./app-28ad1224.js";import{M as ne}from"./Message-2cb98147.js";import{P as ae}from"./Pagination-cbe6df2a.js";var oe=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ie=function(e){return oe.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},le=function(e,t,a){Object.keys(t).filter(ie).forEach(function(r){var n=t[r];typeof n=="function"&&(r==="onInit"?n(e,a):a.on(r.substring(2),function(o){return n(o,a)}))})},re=function(e,t,a,r){var n=e.modelEvents?e.modelEvents:null,o=Array.isArray(n)?n.join(" "):n;w(r,function(c,s){a&&typeof c=="string"&&c!==s&&c!==a.getContent({format:e.outputFormat})&&a.setContent(c)}),a.on(o||"change input undo redo",function(){t.emit("update:modelValue",a.getContent({format:e.outputFormat}))})},se=function(e,t,a,r,n,o){r.setContent(o()),a.attrs["onUpdate:modelValue"]&&re(t,a,r,n),le(e,a.attrs,r)},O=0,U=function(e){var t=Date.now(),a=Math.floor(Math.random()*1e9);return O++,e+"_"+a+O+String(t)},ue=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},L=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},de=function(e,t){return L(e).concat(L(t))},ce=function(e){return e==null},x=function(){return{listeners:[],scriptId:U("tiny-script"),scriptLoaded:!1}},me=function(){var e=x(),t=function(n,o,c,s){var l=o.createElement("script");l.referrerPolicy="origin",l.type="application/javascript",l.id=n,l.src=c;var f=function(){l.removeEventListener("load",f),s()};l.addEventListener("load",f),o.head&&o.head.appendChild(l)},a=function(n,o,c){e.scriptLoaded?c():(e.listeners.push(c),n.getElementById(e.scriptId)||t(e.scriptId,n,o,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},r=function(){e=x()};return{load:a,reinitialize:r}},fe=me(),pe=function(){return typeof window<"u"?window:global},p=function(){var e=pe();return e&&e.tinymce?e.tinymce:null},ge={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},g=globalThis&&globalThis.__assign||function(){return g=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++){t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},g.apply(this,arguments)},ve=function(e,t,a,r){return e(r||"div",{id:t,ref:a})},he=function(e,t,a){return e("textarea",{id:t,visibility:"hidden",ref:a})},ye=N({props:ge,setup:function(e,t){var a=e.init?g({},e.init):{},r=q(e),n=r.disabled,o=r.modelValue,c=r.tagName,s=F(null),l=null,f=e.id||U("tiny-vue"),_=e.init&&e.init.inline||e.inline,b=!!t.attrs["onUpdate:modelValue"],i=!0,D=e.initialValue?e.initialValue:"",S="",R=function(u){return b?function(){return o!=null&&o.value?o.value:""}:function(){return u?D:S}},E=function(){var u=R(i),d=g(g({},a),{readonly:e.disabled,selector:"#"+f,plugins:de(a.plugins,e.plugins),toolbar:e.toolbar||a.toolbar,inline:_,setup:function(v){l=v,v.on("init",function(I){return se(I,e,t,v,o,u)}),typeof a.setup=="function"&&a.setup(v)}});ue(s.value)&&(s.value.style.visibility=""),p().init(d),i=!1};w(n,function(u){var d;l!==null&&(typeof((d=l.mode)===null||d===void 0?void 0:d.set)=="function"?l.mode.set(u?"readonly":"design"):l.setMode(u?"readonly":"design"))}),w(c,function(u){var d;b||(S=l.getContent()),(d=p())===null||d===void 0||d.remove(l),A(function(){return E()})}),G(function(){if(p()!==null)E();else if(s.value&&s.value.ownerDocument){var u=e.cloudChannel?e.cloudChannel:"5",d=e.apiKey?e.apiKey:"no-api-key",v=ce(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+d+"/tinymce/"+u+"/tinymce.min.js":e.tinymceScriptSrc;fe.load(s.value.ownerDocument,v,E)}}),K(function(){p()!==null&&p().remove(l)}),_||(z(function(){i||E()}),H(function(){var u;b||(S=l.getContent()),(u=p())===null||u===void 0||u.remove(l)}));var j=function(u){var d;S=l.getContent(),(d=p())===null||d===void 0||d.remove(l),a=g(g({},a),u),A(function(){return E()})};return t.expose({rerender:j}),function(){return _?ve(P,f,s,e.tagName):he(P,f,s)}}});const Te={components:{Message:ne,Button:Y,editor:ye,SingleSelect:J,Modal:Q,Pagination:ae},mounted(){this.makeRequest("GET",this.endpoints.userStructre).then(e=>{this.userStructure=e.data.data}).catch(e=>{console.log(e.response.data)}),this.makeRequest("GET",this.endpoints.getCategories).then(e=>{this.categories=e.data.data}).catch(e=>{console.log(e.response)}),this.fetchTemplates()},data(){return{emailTemplateOpen:!1,userStructure:{},emailTemplate:{email_category_id:"",template:""},categories:[],templates:[],paginationData:{},edit:!1,tableData:{length:15,currentPage:1},lengthData:[10,15,20,30,40,50,100]}},methods:{setPage(e){this.tableData.currentPage=e,this.fetchTemplates()},fetchTemplates(){this.makeRequest("GET",`${this.endpoints.fetchEmailTemplates}?page=${this.tableData.currentPage}`,this.tableData).then(e=>{this.templates=e.data.data.data,this.paginationData=e.data.data}).catch(e=>{console.log(e.response.data)})},showEmailTemplateModal(){this.emailTemplateOpen=!0},getAttributes(){let e="";for(let t in this.userStructure)e+=`$${t}$ , `;return e},addEmailTemplate(){this.showLoader(),this.makeRequest("POST",this.endpoints.createEmailTemplate,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error creating template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},editTemplate(e){this.emailTemplate={...e},this.emailTemplateOpen=!0,this.edit=!0},editEmailTemplate(){this.showLoader(),this.makeRequest("PUT",`${this.endpoints.updateEmailTemplate}/${this.emailTemplate.id}`,this.emailTemplate).then(e=>{this.sweetAlert().success("Email template Edit successfully saved"),this.emailTemplateOpen=!1,this.emailTemplate={email_category_id:"",template:""},this.edit=!1,this.fetchTemplates()}).catch(e=>{this.sweetAlert().error("Error editing template"),console.log(e.response.data)}).finally(()=>{this.hideLoader()})},deleteTemplate(e){confirm("Are you sure you want to delete this template?")&&this.makeRequest("DELETE",`${this.endpoints.deleteEmailTemplate}/${e}`).then(t=>{this.sweetAlert().success("Template deleted successfully"),this.fetchTemplates()}).catch(t=>{this.sweetAlert().error("Error deleting template"),console.log(t.response.data)})}}},_e={class:"button-container"},be=["value"],Ee=["value"],Ce=m("div",{class:"line"},null,-1),Se=m("h2",{class:"head"},"Email Templates",-1),De={class:"messages"},ke=["onClick"],we=["onClick"],Ae=m("b",null,"You can use any of these attributes:",-1),Pe=m("br",null,null,-1),Me=m("div",{class:"line"},null,-1);function Ve(e,t,a,r,n,o){const c=h("Button"),s=h("Message"),l=h("Pagination"),f=h("SingleSelect"),_=h("editor"),b=h("Modal");return y(),C("div",null,[m("div",_e,[T(c,{text:"ADD EMAIL TEMPLATE",color:"primary",icon:"mdi mdi-plus-box",onButtonClicked:t[0]||(t[0]=i=>o.showEmailTemplateModal())}),X(m("select",{class:"form-control select-legnth",name:"",id:"","onUpdate:modelValue":t[1]||(t[1]=i=>n.tableData.length=i),onChange:t[2]||(t[2]=i=>o.fetchTemplates())},[(y(!0),C(M,null,V(n.lengthData,i=>(y(),C("option",{key:i,value:i},B(i),9,be))),128)),n.paginationData.total?(y(),C("option",{key:0,value:n.paginationData.total},"All",8,Ee)):$("",!0)],544),[[Z,n.tableData.length]])]),Ce,Se,m("div",De,[(y(!0),C(M,null,V(n.templates,i=>(y(),ee(s,{key:i.id,message:i.template,category:"Category:"+i.category?i.category.name:""},{actions:k(()=>[m("button",{onClick:D=>o.editTemplate(i)},"Edit",8,ke),m("button",{onClick:D=>o.deleteTemplate(i.id)},"Delete",8,we)]),_:2},1032,["message","category"]))),128))]),T(l,{from:n.paginationData.from,to:n.paginationData.to,links:n.paginationData.links,total:n.paginationData.total,onPageClicked:o.setPage},null,8,["from","to","links","total","onPageClicked"]),T(b,{id:"addEmailTemplate",title:"Add Email Template",open:n.emailTemplateOpen,onClosed:t[6]||(t[6]=i=>n.emailTemplateOpen=!1),large:!0},{buttons:k(()=>[T(c,{icon:"mdi-book",text:n.edit?"Edit Template":"Submit Template",color:"primary",onButtonClicked:t[5]||(t[5]=i=>n.edit?o.editEmailTemplate():o.addEmailTemplate())},null,8,["text"])]),default:k(()=>[m("div",null,[m("div",null,[Ae,Pe,te(B(o.getAttributes()),1)]),Me,T(f,{options:n.categories,custom_value:"id",modelValue:n.emailTemplate.email_category_id,"onUpdate:modelValue":t[3]||(t[3]=i=>n.emailTemplate.email_category_id=i),text:"name",label:"Category"},null,8,["options","modelValue"]),T(_,{init:{height:200,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","media table paste code help wordcount"],toolbar:"undo redo | formatselect | bold italic backcolor |                             alignleft aligncenter alignright alignjustify |                             bullist numlist outdent indent | removeformat | help"},modelValue:n.emailTemplate.template,"onUpdate:modelValue":t[4]||(t[4]=i=>n.emailTemplate.template=i)},null,8,["modelValue"])])]),_:1},8,["open"])])}const xe=W(Te,[["render",Ve]]);export{xe as default};
